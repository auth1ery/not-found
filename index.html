<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>404 — Not Found</title>
  <style>
    * { box-sizing: border-box; font-family: monospace; }
    html, body {
      margin: 0;
      height: 100%;
      background: #000;
      color: #fff;
    }
    .centered {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      text-align: center;
      gap: 16px;
    }
    h1, h2, p {
      margin: 0;
      padding: 0;
    }
    button {
      background: none;
      color: #fff;
      border: 1px solid #fff;
      padding: 8px 20px;
      cursor: pointer;
      transition: 0.2s;
    }
    button:hover {
      background: #fff;
      color: #000;
    }
    input {
      background: #000;
      color: #fff;
      border: 1px solid #fff;
      padding: 6px 10px;
      text-align: center;
      width: 220px;
    }
    footer {
      position: fixed;
      bottom: 10px;
      width: 100%;
      text-align: center;
      font-size: 12px;
      color: #555;
    }
    .hidden { display: none; }
    .flash {
      animation: flash 0.1s alternate 3;
    }
    @keyframes flash {
      from { background: #000; color: #fff; }
      to { background: #fff; color: #000; }
    }
  </style>
</head>
<body>

  <!-- Main Menu -->
  <div id="menu" class="centered">
    <h1>not-found</h1>
    <button id="newGame">New Game</button>
    <button id="loadGame">Load</button>
  </div>

  <!-- Game Container -->
  <div id="game" class="hidden"></div>

  <footer>v0.5 — minimalist build</footer>

  <script>
    const menu = document.getElementById('menu');
    const game = document.getElementById('game');
    let save = JSON.parse(localStorage.getItem('notFoundSave')) || { level: 1 };

    document.getElementById('newGame').onclick = () => startGame(true);
    document.getElementById('loadGame').onclick = () => startGame(false);

    function startGame(reset) {
      if (reset) {
        save = { level: 1 };
        localStorage.setItem('notFoundSave', JSON.stringify(save));
      }
      menu.classList.add('hidden');
      game.classList.remove('hidden');
      loadLevel(save.level);
    }

    function saveProgress(level) {
      save.level = level;
      localStorage.setItem('notFoundSave', JSON.stringify(save));
    }

    // Core loader
    function loadLevel(n) {
      switch (n) {
        case 1: level1(); break;
        case 2: level2(); break;
        case 3: level3(); break;
        case 4: level4(); break;
        case 5: level5(); break;
        default: ending();
      }
    }

    function next(level) {
      saveProgress(level + 1);
      setTimeout(() => loadLevel(save.level), 1200);
    }

    // -------- LEVEL 1 -------- //
    function level1() {
      game.innerHTML = `
        <div class="centered">
          <h2>Level 1 — Missing File</h2>
          <p>The stylesheet was not found.</p>
          <code>GET /assets/style.css 404 (Not Found)</code>
          <input id="pathInput" placeholder="/assets/style.css" />
          <button id="fixBtn">Fix</button>
        </div>`;
      const fixBtn = document.getElementById('fixBtn');
      const input = document.getElementById('pathInput');
      fixBtn.onclick = () => {
        if (input.value.trim() === '/styles/style.css') {
          game.innerHTML = `<div class='centered flash'><h2>File restored.</h2><p>Welcome back.</p></div>`;
          next(1);
        } else {
          fixBtn.textContent = '❌ Try Again';
          setTimeout(() => fixBtn.textContent = 'Fix', 1000);
        }
      };
    }

    // -------- LEVEL 2 -------- //
    function level2() {
      game.innerHTML = `
        <div class="centered" style="color:#000;">
          <h2 style="color:#000;">Level 2 — Invisible Words</h2>
          <p style="color:#000;">It's all here. You just can't see it.</p>
          <button id="revealBtn">Reveal</button>
        </div>`;
      const reveal = document.getElementById('revealBtn');
      reveal.onclick = () => {
        game.classList.add('flash');
        setTimeout(() => {
          game.innerHTML = `
            <div class='centered'>
              <h2>Visible.</h2>
              <p>Good. You can see the unseen.</p>
            </div>`;
          next(2);
        }, 300);
      };
    }

    // -------- LEVEL 3 -------- //
    function level3() {
      game.innerHTML = `
        <div class="centered">
          <h2>Level 3 — Broken Script</h2>
          <p>Button does nothing. Console says:</p>
          <code>Uncaught ReferenceError: memory is not defined</code>
          <input id="term" placeholder="Type code here..." />
          <button id="runBtn">Run</button>
        </div>`;
      const run = document.getElementById('runBtn');
      const term = document.getElementById('term');
      run.onclick = () => {
        if (term.value.trim() === 'let memory = "restored";') {
          game.innerHTML = `<div class='centered flash'><h2>Memory restored.</h2><p>Proceed.</p></div>`;
          next(3);
        } else {
          run.textContent = '⚠️ Error';
          setTimeout(() => run.textContent = 'Run', 1000);
        }
      };
    }

    // -------- LEVEL 4 -------- //
    function level4() {
      game.innerHTML = `
        <div class="centered">
          <h2>Level 4 — Lost Links</h2>
          <p>Reorder the links correctly.</p>
          <ul id="links" style="list-style:none;padding:0;">
            <li draggable="true">home</li>
            <li draggable="true">about</li>
            <li draggable="true">contact</li>
            <li draggable="true">archive</li>
          </ul>
        </div>`;
      const list = document.getElementById('links');
      let drag;
      list.querySelectorAll('li').forEach(li => {
        li.style.border = '1px solid #fff';
        li.style.padding = '4px 10px';
        li.style.margin = '4px 0';
        li.ondragstart = e => drag = li;
        li.ondragover = e => e.preventDefault();
        li.ondrop = e => {
          e.preventDefault();
          if (drag && drag !== li) {
            list.insertBefore(drag, li.nextSibling);
            checkOrder();
          }
        };
      });
      function checkOrder() {
        const order = [...list.children].map(li => li.textContent);
        const correct = ['archive','home','contact','about'];
        if (JSON.stringify(order) === JSON.stringify(correct)) {
          game.innerHTML = `<div class='centered flash'><h2>Order restored.</h2><p>The Net remembers its structure.</p></div>`;
          next(4);
        }
      }
    }

    // -------- LEVEL 5 -------- //
    function level5() {
      game.innerHTML = `
        <div class="centered">
          <h2>Level 5 — Echoes of Code</h2>
          <pre id="code">
&lt;!-- DO NOT RESTORE THIS --&gt;
&lt;!-- WE WERE ERASED FOR A REASON --&gt;
&lt;!-- STOP --&gt;
          </pre>
          <button id="restoreBtn">Uncomment</button>
        </div>`;
      const restore = document.getElementById('restoreBtn');
      restore.onclick = () => {
        game.innerHTML = `
          <div class='centered flash'>
            <h2>You shouldn't have done that.</h2>
            <p>They see you now.</p>
          </div>`;
        next(5);
      };
    }

    // -------- END -------- //
    function ending() {
      game.innerHTML = `
        <div class="centered">
          <h2>End of Prototype</h2>
          <p>More fragments await...</p>
          <button id="restartBtn">Return to Menu</button>
        </div>`;
      document.getElementById('restartBtn').onclick = () => {
        menu.classList.remove('hidden');
        game.classList.add('hidden');
      };
    }
  </script>
</body>
</html>
